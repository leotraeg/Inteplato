<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="Leonard Traeger">

	<title>Inteplato</title>

	<!-- Bootstrap core CSS -->
	<link href="./bootstrap5/css/bootstrap.min.css" rel="stylesheet" />

	<!-- Custom styles for this template -->
	<link href="./assets/css/dashboard.css" rel="stylesheet">
	<link href="./assets/css/svg.css" rel="stylesheet">

	<!-- Fonts     -->
	<link href='http://fonts.googleapis.com/css?family=Oswald:400,300,700' rel='stylesheet' type='text/css'>

	<!-- Colorpicker-->
	<link rel="stylesheet" href="./assets/css/colorPick.css">

	<!-- Favicons -->

	<!-- Theme copied from https://getbootstrap.com/docs/4.1/examples/dashboard/#  -->

</head>

<body>


	<nav class="navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow">
		<a class="navbar-brand col-sm-3 col-md-2 mr-0" href="#">
			<h4>Inteplato</h2>
		</a>
		<ul class="navbar-nav px-3">
			<li class="nav-item text-nowrap">
				<a class="nav-link" href="#">Sign out</a>
			</li>
		</ul>
	</nav>

	<div class="container-fluid">
		<div class="row">
			<nav class="col-md-2 d-none d-md-block bg-light sidebar">
				<div class="sidebar-sticky">
					<h6
						class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
						<span>Schema universe options</span>
					</h6>
					<ul class="nav flex-column">
						<li id="insertschema" class="nav-item" data-bs-toggle="modal"
							data-bs-target="#insertSchemaModal">
							<a class="nav-link" href="#">
								<span data-feather="plus-circle"></span>
								Upload new schema
							</a>
						</li>
						<li id="clearschema" class="nav-item">
							<a class="nav-link" href="#">
								<span data-feather="x"></span>
								Delete schema
							</a>
						</li>

					</ul>
					<h6
						class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-2 mb-1 text-muted">
						<span>Global schema options</span>
						<div class="picker float-end" id="colorpickerglobalconcept"></div>
					</h6>
					<ul class="nav flex-column">
						<li id="newglobaltableconcept" class="nav-item">
							<a class="nav-link" href="#">
								<span data-feather="plus-circle"></span>
								New global table
							</a>
						</li>
						<li id="newglobalattributeconcept" class="nav-item">
							<a class="nav-link" href="#">
								<span data-feather="plus-circle"></span>
								New global attribute
							</a>
						</li>
					</ul>
					<h6
						class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
						<span>Concept filter options</span>
					</h6>
					<ul class="nav flex-column mb-2">
						<li class="nav-item">
							<a class="nav-link">
								<div class="form-check form-switch">
									<label class="form-check-label" for="tablesfilter">Tables</label>
									<input class="form-check-input" type="checkbox" id="tablesfilter" checked>
								</div>
							</a>
							<a class="nav-link">
								<div class="form-check form-switch">
									<label class="form-check-label" for="attributesfilter">Attributes</label>
									<input class="form-check-input" type="checkbox" id="attributesfilter" checked>
								</div>
							</a>
						</li>
					</ul>
					<h6
						class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
						<span>Path filter options</span>
						<a class="d-flex align-items-center text-muted" href="#">

						</a>
					</h6>
					<ul class="nav flex-column mb-2">
						<li class="nav-item">
							<a class="nav-link">
								<div class="form-check form-switch">
									<label class="form-check-label" for="tabtoattrfilter">Table to attributes</label>
									<input class="form-check-input" type="checkbox" id="tabtoattrfilter" checked>
								</div>
							</a>
							<a class="nav-link">
								<div class="form-check form-switch">
									<label class="form-check-label" for="globaltolocalfilter">Global to local</label>
									<input class="form-check-input" type="checkbox" id="globaltolocalfilter" checked>
								</div>
							</a>
						</li>

					</ul>
				</div>
			</nav>
			<main role="main" class="col-md-9 ms-auto col-lg-10 px-4">
				<div
					class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
					<h1 class="h2">Dashboard</h1>
					<div class="btn-toolbar mb-2 mb-md-0">
						<div class="btn-group mr-2">
							<button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal"
								data-bs-target="#previewConceptList">
								Concept List
								<span data-feather="eye"></span>
							</button>
						</div>
						<div class="btn-group mr-2">
							<button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal"
								data-bs-target="#previewConceptListHotEnc">
								CL HotEnc
								<span data-feather="list"></span>
							</button>
						</div>
						<div class="btn-group mr-2">
							<button id="localMatcher" class="btn btn-sm btn-outline-secondary">
								Local Max Matcher
								<span data-feather="life-buoy"></span>
							</button>
						</div>
						<div class="btn-group mr-2">
							<button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal"
								data-bs-target="#previewMetadata">
								Metadata Table
								<span data-feather="eye"></span>
							</button>
						</div>

					</div>
				</div>

				<!-- MODAL InsertSchemaModal -->
				<div class="modal fade" id="insertSchemaModal" tabindex="-1" aria-labelledby="modelinsertschema"
					aria-hidden="true">
					<div class="modal-dialog modal-xl modal-dialog-centered">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title" id="modelinsertschema">Upload new XML-DDL schema</h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal"
									aria-label="Close"></button>
							</div>
							<div class="modal-body">
								<div role="tabpanel">
									<ul class="nav nav-tabs" id="myTab" role="tablist">
										<li class="nav-item">
											<button class="nav-link" id="addSchemaModal" type="button"
												role="tab">+</button>
										</li>
										<li class="nav-item" role="presentation">
											<button class="nav-link active" id="global" data-bs-toggle="tab"
												data-bs-target="#globaltar" type="button" role="tab"
												aria-controls="globaltar" aria-selected="true">Global schema</button>
										</li>
									</ul>
									<div class="tab-content" id="myTabContent">
										<div class="tab-pane fade" id="globaltar" role="tabpanel"
											aria-labelledby="global">
											<div class="form-floating">
												Choose color on main screen
												<select class="form-select form-select-sm" id='formatSchemaModelGlobal'>
													<option>Select data format</option>
													<option value="DDLMySQL">DDLMySQL</option>
													<option value="XMLOracle" selected>XMLOracle</option>
												</select>
												<textarea class="form-control" id="modalSchemaGlobal"
													style="height: 500px"></textarea>
											</div>
										</div>
									</div>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-secondary"
										data-bs-dismiss="modal">Close</button>
									<button id="importAllSchemaFormats" type="button" class="btn btn-primary">Import all
										schema formats into Concept List</button>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- MODAL preview Concept List .modal-fullscreen -->
				<div class="modal fade" id="previewConceptList" tabindex="-1" aria-labelledby="modalconceptlist"
					aria-hidden="true">
					<div class="modal-dialog modal-xl modal-dialog-centered">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title" id="modalconceptlist">Concept List</h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal"
									aria-label="Close"></button>
							</div>
							<div class="modal-body table-responsive">
								<div id="conceptlistalerts"></div>
								<table id="conceptListTable" class="table table-striped table-hover table-sm ">
									<thead>
										<tr>
											<th scope="col"></th>
											<th scope="col">Id</th>
											<th scope="col">Concept Name</th>
											<th scope="col">Refined Name</th>
											<th scope="col">Synonyms</th>
											<th scope="col">Parent #</th>
											<th scope="col">Type</th>
											<th scope="col">Schema</th>
											<th scope="col">Data Type</th>
											<th scope="col">Constraint</th>
											<th scope="col">Constraint ref #</th>
											<th scope="col">Global #</th>
										</tr>
									</thead>
									<tbody>
									</tbody>
								</table>

								<div class="modal-footer">
									<button type="button" class="btn btn-secondary"
										data-bs-dismiss="modal">Close</button>
									<button id="drawSelectedConcepts" type="button" class="btn btn-primary">Draw
										Selected Concepts</button>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- MODAL preview Concept List Hot Encoded .modal-fullscreen -->
				<div class="modal fade" id="previewConceptListHotEnc" tabindex="-1"
					aria-labelledby="modalConceptListHotEnc" aria-hidden="true">
					<div class="modal-dialog modal-xl modal-dialog-centered">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title" id="modalConceptListHotEnc">Concept List Hot Encoded</h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal"
									aria-label="Close"></button>
							</div>
							<div class="modal-body table-responsive">
								<div id="conceptlistalertsHotEnc"></div>
								<div>
									<button id="CLHotEncCSVDownload" type="button" class="btn btn-primary">Download as
										CSV</button>
									<button type="button" class="btn btn-secondary"
										data-bs-dismiss="modal">Close</button>
								</div>
								<table id="conceptListTableHotEnc" class="table table-striped table-hover table-sm ">
									<thead>
										<tr>
											<th scope="col">id</th>
											<th scope="col">refined_local_name</th>
											<th scope="col">parent_id</th>
											<th scope="col">schema</th>
											<th scope="col">vec_type_schema</th>
											<th scope="col">vec_type_table</th>
											<th scope="col">vec_type_attribute</th>
											<th scope="col">vec_datatype_numeric</th>
											<th scope="col">vec_datatype_text</th>
											<th scope="col">vec_datatype_date</th>
											<th scope="col">vec_datatype_miscellaneous</th>
											<th scope="col">vec_constraint_pk</th>
											<th scope="col">vec_constraint_fk</th>
											<th scope="col">constraint_ref_id</th>
											<th scope="col">vec_constraint_notnull</th>
											<th scope="col">vec_constraint_default</th>
											<th scope="col">vec_constraint_unique</th>
											<th scope="col">vec_constaint_check</th>
											<th scope="col">global_id</th>
										</tr>
									</thead>
									<tbody>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>

				<!-- MODAL preview Concept List .modal-fullscreen -->
				<div class="modal fade" id="previewMetadata" tabindex="-1" aria-labelledby="modalmetadata"
					aria-hidden="true">
					<div class="modal-dialog modal-xl modal-dialog-centered">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title" id="modalmetadata">Metadata Table</h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal"
									aria-label="Close"></button>
							</div>
							<div class="modal-body table-responsive">
								<table id="metadataTable" class="table table-striped table-hover table-sm ">
									<thead>
										<tr>
											<th scope="col">#</th>
											<th scope="col">Global Concept Name</th>
											<th scope="col">Transformation rule for schema 1</th>
											<th scope="col">Transformation rule for schema 2</th>
											<th scope="col">Transformation rule for schema 3</th>
										</tr>
									</thead>
									<tbody>
									</tbody>
								</table>

								<div class="modal-footer">
									<button type="button" class="btn btn-secondary"
										data-bs-dismiss="modal">Close</button>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- MODAL local concept finder -->
				<div class="modal fade" id="previewlocalconceptfinder" tabindex="-1"
					aria-labelledby="modallocalconceptfinder" aria-hidden="true">
					<div class="modal-dialog modal-xl modal-dialog-centered">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title" id="modallocalconceptfinder">Local concept finder</h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal"
									aria-label="Close"></button>
							</div>
							<div class="modal-body table-responsive">
								<div id="localconceptfinderalerts"></div>
								<p class="h6" id="localconceptfinderheader"></p>
								<table id="localConceptFinderMatches" class="table table-striped table-hover table-sm ">
									<thead>
									</thead>
									<tbody>
									</tbody>
								</table>

								<div class="modal-footer">
									<button type="button" class="btn btn-secondary"
										data-bs-dismiss="modal">Close</button>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="row ">
					<div id="schemuniv" class="col-md-10">
						<div id="dashboardalerts"></div>
						<div class="border border-3 bg-light">
							<div class="d-flex justify-content-center">
								<p class="h5">Schema Universe</p>
							</div>
							<div class="float-end">
								<b>+</b> <input id="schema1slider" type="range" min="1" max="200" value="50"
									class="slider" id="myRange"> <b>-</b>
							</div>
						</div>
						</br>

						<div id="schema1" class="d-flex border border-1 bg-light">
						</div>
					</div>

					<div id="meta" class="col-md-2">
						<div id="conceptmeta" class="border border-3 bg-light">
							<div class="d-flex justify-content-center">
								<p class="h5">Concept Detailview</p>
							</div>

							<table class="table table-striped table-hover table-responsive">
								<tbody>
									<tr style="display:none;">
										<th scope="row">ID</th>
										<td><input id="conceptid" class="form-control" type="text" value="" disabled>
										</td>
									</tr>
									<tr>
										<th scope="row">Name</th>
										<td><input id="conceptname" class="form-control" type="text" value="" disabled>
										</td>
									</tr>
									<tr>
										<th scope="row">Type</th>
										<td><input id="concepttype" class="form-control" type="text" value="" disabled>
										</td>
									</tr>
									<tr>
										<th scope="row">Data Type</th>
										<td><input id="conceptdatatype" class="form-control" type="text" value=""
												disabled>
										</td>
									</tr>
									<tr>
										<th scope="row">Constraint</th>
										<td><input id="conceptconstraint" class="form-control" type="text" value=""
												disabled>
										</td>
									</tr>
									<tr>
										<th scope="row">Table Source</th>
										<td><input id="concepttablesource" class="form-control" type="text" value=""
												disabled></td>
									</tr>
									<tr>
										<th scope="row">Schema Source</th>
										<td><input id="conceptschemasource" class="form-control input-group-sm"
												type="text" value="" disabled></td>
									</tr>
								</tbody>
							</table>
						</div>

						</br>

						<div id="globalconceptmeta" class="border border-3 bg-light invisible">
							<div class="d-flex justify-content-center bg-white">
								<p class="h5" style="display: inline-block">Global-to-local relationships</p>
								<button id="localconceptfinderbutton" class="btn btn-sm btn-outline-secondary"
									data-bs-toggle="modal" data-bs-target="#previewlocalconceptfinder">
									<span data-feather="life-buoy"></span>
								</button>
								<button type="button" class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal"
									data-bs-target="#edittransformation">
									<span data-feather="edit"></span>
								</button>
							</div>
							<p class="h6 text-start">Local Schema 1</p>
							<ul id="globalrel1" class="list-group"></ul>
							</br>
							<p class="h6">Local Schema 2</p>
							<ul id="globalrel2" class="list-group"></ul>
							</br>
							<p class="h6">Local Schema 3</p>
							<ul id="globalrel3" class="list-group"></ul>
						</div>
					</div>

					<!-- MODAL Transformation Rules -->
					<div class="modal fade" id="edittransformation" tabindex="-1" aria-labelledby="modaltransformation"
						aria-hidden="true">
						<div class="modal-dialog modal-dialog-centered modal-lg">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="modaltransformation">Transformation rules for local
										concepts</h5>
									<button type="button" class="btn-close" data-bs-dismiss="modal"
										aria-label="Close"></button>
								</div>
								<div class="modal-body">
									<p class="h6" id="edittransformationheader"></p>
									<div class="d-flex">
										<div class="nav flex-column nav-pills me-3" id="v-pills-tab" role="tablist"
											aria-orientation="vertical">
											<button class="nav-link active" id="tab-transform-local-1"
												data-bs-toggle="pill" data-bs-target="#transform-local-1" type="button"
												role="tab" aria-controls="transform-local-1" aria-selected="true">Local
												Schema 1</button>
											<button class="nav-link" id="tab-transform-local-2" data-bs-toggle="pill"
												data-bs-target="#transform-local-2" type="button" role="tab"
												aria-controls="transform-local-2" aria-selected="false">Local Schema
												2</button>
											<button class="nav-link" id="tab-transform-local-3" data-bs-toggle="pill"
												data-bs-target="#transform-local-3" type="button" role="tab"
												aria-controls="transform-local-3" aria-selected="false">Local Schema
												3</button>
										</div>
										<div class="tab-content flex-fill" id="sqlstrings">
											<div class="tab-pane fade show active" id="transform-local-1"
												role="tabpanel" aria-labelledby="tab-transform-local-1">
												<textarea id="textareatransform1" class="form-control"
													style="height: 350px"></textarea>
											</div>
											<div class="tab-pane fade flex-fill" id="transform-local-2" role="tabpanel"
												aria-labelledby="tab-transform-local-2">
												<textarea id="textareatransform2" class="form-control"
													style="height: 350px"></textarea>
											</div>
											<div class="tab-pane fade flex-fill" id="transform-local-3" role="tabpanel"
												aria-labelledby="tab-transform-local3">
												<textarea id="textareatransform3" class="form-control"
													style="height: 350px"></textarea>
											</div>
										</div>
										<div class="list-group" id="sqlelementlist">
										</div>
										<div class="list-group" id="sqlrelatedconcepts">
										</div>
									</div>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-secondary"
										data-bs-dismiss="modal">Close</button>
									<button id="modalsavetransformation" type="button" class="btn btn-primary">Save
										Transformation Rules</button>
								</div>
							</div>
						</div>
					</div>

			</main>
		</div>
	</div>


	<script src="./bootstrap5/js/bootstrap.min.js"></script>
	<script src="./assets/js/jquery-3.5.1.slim.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<script src="https://d3js.org/d3.v6.min.js"></script>
	<script src="./assets/js/colorPick.js"></script>


	<script src="./assets/js/conceptConstructor.js"></script>
	<script src="./assets/js/algorithm.js"></script>

	<script>
		$(function () {
			//MODAL and SAMPLE XML
			let xml1;
			fetch('./dboneschema.txt')
				.then(response => response.text())
				.then((data) => {
					xml1 = data;
				});

			//let xml2;
			// fetch('./dbtwoschema.txt')
			// 	.then(response => response.text())
			// 	.then((data) => {
			// 		xml2 = data;
			// 	});

			let SampleDDLMySQL;
			fetch('./mysqlschema4Inteplato.sql')
				.then(response => response.text())
				.then((data) => {
					SampleDDLMySQL = data;
				});

			let SampleXMLSAP;
			fetch('./sapschema4Inteplato.txt')
				.then(response => response.text())
				.then((data) => {
					SampleXMLSAP = data;
				});
			
			let SampleXMLOracleCO;
			fetch('./oracleschemaCO4Inteplato.txt')
				.then(response => response.text())
				.then((data) => {
					SampleXMLOracleCO = data;
				});
			
			let SampleXMLOracleHR;
			fetch('./oracleschemaHR4Inteplato.txt')
				.then(response => response.text())
				.then((data) => {
					SampleXMLOracleHR = data;
				});

			let xml4;
			fetch('./dbfourschema.txt')
				.then(response => response.text())
				.then((data) => {
					xml4 = data;
				});

			let xmlglobal;
			fetch('./dbglobalschemac.txt')
				.then(response => response.text())
				.then((data) => {
					xmlglobal = data;
				});



			// ADD LOCAL SCHEMA dark red: #45150F darknormal red: #561A13 normal red: #A93226
			let schemaColorPlate = ["#A93226", "#884EA0", "#2471A3", "#17A589", "#229954", "#CA6F1E"];
			let numberOfLocalSchemas = [];
			$('#addSchemaModal').on('click', function () {
				numberOfLocalSchemas.push(numberOfLocalSchemas.length + 1);
				let schemaCounter = numberOfLocalSchemas.length;
				let newTab = "<li class='nav-item' role='presentation'><button class='nav-link' id='xml" + schemaCounter + "' data-bs-toggle='tab' data-bs-target='#xml" + schemaCounter + "tar' type='button' role='tab' aria-controls='#xml" + schemaCounter + "tar' aria-selected='false'>Local Schema " + schemaCounter + "</button></li>";
				$("#myTab").append(newTab);

				let newTabContent = "<div class='tab-pane fade' id='xml" + schemaCounter + "tar' role='tabpanel' aria-labelledby='xml" + schemaCounter + "'><div class='form-floating'><div class='picker' id='colorpickermodal" + schemaCounter + "'></div>";
				let fileFormatSelection = "<select class='form-select form-select-sm' id='formatSchemaModel" + schemaCounter + "'><option>Select data format</option>";
				fileFormats.forEach(function (fileFormat) {
					fileFormatSelection = fileFormatSelection + "<option value='" + fileFormat + "'>" + fileFormat + "</option>"
				})
				let textInputArea = "</select><textarea class='form-control' id='modalSchema" + schemaCounter + "'style='height: 500px'></textarea></div>";
				$("#myTabContent").append(newTabContent + fileFormatSelection + textInputArea);

				$("#colorpickermodal" + schemaCounter).colorPick({
					'initialColor': schemaColorPlate[schemaCounter],
					'allowVertical': false,
					'palette': schemaColorPlate,
					'onColorSelected': function () {
						this.element.css({ 'backgroundColor': this.color, 'color': this.color });
					}
				});

				//QS Auto fill schemas
				switch (schemaCounter) {
					//case 1: $("#modalSchema1").empty(); $("#modalSchema1").val(SampleXMLOracleCO); $('#formatSchemaModel1').find(":selected").val("XMLOracle");
						//break;
					case 1: $("#modalSchema1").empty(); $("#modalSchema2").val(SampleDDLMySQL); $('#formatSchemaModel1').find(":selected").val("DDLMySQL");
						break;
					case 2: $("#modalSchema2").empty(); $("#modalSchema3").val(SampleXMLSAP); $('#formatSchemaModel2').find(":selected").val("XMLOracle");
						break;
				}
			});

			// COLOR PICKER
			$("#colorpickerglobalconcept").colorPick({
				'initialColor': '#A93226',
				'allowVertical': true,
				'palette': schemaColorPlate,
				'onColorSelected': function () {
					this.element.css({ 'backgroundColor': this.color, 'color': this.color });
				}
			});

			// EVENTHANDLERS + EVENTS FOR conceptG ELEMENTS 
			$('#conceptname').on('input', function () {
				var concept = concept_id_to_concept($('#conceptid').val());
				concept.set_drawn_concept_text($('#conceptname').val().toUpperCase());
				concept.name = $('#conceptname').val().toUpperCase();
				concept.refined_local_name = $('#conceptname').val().toUpperCase();
				concept.synonyms_retrieved = false;
				concept.synonyms = [];
			});


			$.fn.addGlobalTableConcept = function () {
				var concept_schema_obj = conceptList.find(concept => concept.name === 'global');
				if (concept_schema_obj === undefined) {
					concept_schema_obj = new concept('global');
				};

				concept_schema_obj.add_child_concept("GlobalTable").draw_concept(svg);
			};

			$.fn.addGlobalAttributeConcept = function () {
				var global_concept = concept_id_to_concept($("#conceptid").val());
				if (global_concept === undefined ||
					global_concept.schema != 'global' ||
					global_concept.type != 'table') {
					$.fn.push_alert("dashboardalerts", "warning",
						"Select a global table or create a new one to append a global attribute to it!");
				} else {
					global_concept.add_child_concept("GlobalAttribute").draw_concept(svg);
				}
			};

			let fileFormats = ['DDLMySQL', 'XMLOracle'];
			$.fn.fileToConceptList = function (inputSchemaFile, schemaName, fileFormat) {
				// check for existing schema
				var concept_schema_obj = conceptList.find(concept => concept.name === schemaName);
				if (concept_schema_obj === undefined && fileFormat !== "Select data format") {
					concept_schema_obj = new concept(schemaName);
				};

				switch (fileFormat) {
					case 'XMLOracle':
						//Parse the given XML
						var xmlDoc = $.parseXML(inputSchemaFile);
						var $xml = $(xmlDoc);

						// Find table 
						var $table = $xml.find("TABLE");

						// add tables and columns in a first step
						$table.each(function () {
							var table_name = $(this).find('NAME').first().text();
							let table_concept = new concept(table_name, concept_schema_obj.id);

							var $attribute = $(this).find("COL_LIST").first().children("COL_LIST_ITEM");

							$attribute.each(function () {
								var attribute_name = $(this).find('NAME').first().text();
								var attribute_data_type = $(this).find('DATATYPE').first().text();
								table_concept.add_child_concept(attribute_name, attribute_data_type);
							});
						});

						// add constraints in a second step
						$table.each(function () {
							var table_name = $(this).find('NAME').first().text();
							var $primarykey = $(this).find("PRIMARY_KEY_CONSTRAINT_LIST").first().children("PRIMARY_KEY_CONSTRAINT_LIST_ITEM");

							$primarykey.each(function () {
								var primarykey_name = $(this).find('COL_LIST').find('COL_LIST_ITEM').find('NAME').text();
								conceptList.find(concept => concept.name === primarykey_name && concept.parent_name === table_name).
									set_constraint('PRIMARY KEY');
							});
						});

						$table.each(function () {
							var table_name = $(this).find('NAME').first().text();
							var $foreignkey = $(this).find("FOREIGN_KEY_CONSTRAINT_LIST").children("FOREIGN_KEY_CONSTRAINT_LIST_ITEM");

							$foreignkey.each(function () {
								var foreignkey_name = $(this).find('COL_LIST').find('COL_LIST_ITEM').find('NAME').first().text();
								var foreignkey_table_ref = $(this).find('REFERENCES').find('NAME').first().text();
								var foreignkey_attribute_ref = $(this).find('REFERENCES').find('COL_LIST').find('COL_LIST_ITEM').find('NAME').text();

								//find in conceptList the primary and foreign key attribute concept
								var foreignkey_concept = conceptList.find(concept => concept.name === foreignkey_name &&
									concept.parent_name === table_name);
								var primarykey_concept = conceptList.find(concept => concept.name === foreignkey_name &&
									concept.constraint_name === 'PRIMARY KEY');

								if (foreignkey_concept != undefined && primarykey_concept != undefined) {
									foreignkey_concept.set_constraint('FOREIGN KEY', primarykey_concept.id);
								} else if (foreignkey_concept != undefined && primarykey_concept == undefined) {
									foreignkey_concept.set_constraint('FOREIGN KEY', 'N/A');
								};

							});
						});
						break;
					case 'DDLMySQL':
						inputSchemaFile = inputSchemaFile.toUpperCase();
						if (inputSchemaFile.includes("DROP TABLE IF EXISTS")) {
							let prefix = "DROP TABLE IF EXISTS";
							let suffix = ";";
							const regex = new RegExp(prefix + ".*" + suffix, "ig"); //for letters [a-z]*
							inputSchemaFile = inputSchemaFile.replaceAll(regex, '');
						}

						let tables = inputSchemaFile.split("CREATE TABLE ");

						if (tables[0].indexOf("CREATE DATABASE") >= 0) {
							tables.splice(0, 1);
						};

						tables.forEach(function (table) {
							let table_name = table.substring(table.indexOf("'") + 1, table.indexOf("'", 2));
							table = table.replace(" '" + table_name + "' (", '');
							let table_concept = new concept(table_name, concept_schema_obj.id);

							let tableRecords = table.split("\n");
							tableRecords.splice(0, 1); //delete table name

							console.log(tableRecords);
							tableRecords.forEach(function (tableRecord) {
								if (!tableRecord.includes("PRIMARY KEY") && !tableRecord.includes("KEY") && !tableRecord.includes("CONSTRAINT")) {
									let attribute_name = tableRecord.substring(tableRecord.indexOf("'") + 1, tableRecord.lastIndexOf("'"));
									if (!attribute_name == "") {
										tableRecord = tableRecord.replace("  '" + attribute_name + "' ", '');

										let attribute_data_type = tableRecord.substring(0, tableRecord.indexOf(" "));
										if (attribute_data_type == '') {
											attribute_data_type = tableRecord.substring(0, tableRecord.indexOf(","));
										}
										let attribute_concept = table_concept.add_child_concept(attribute_name, attribute_data_type);

										tableRecord = tableRecord.replace(attribute_data_type + " ", '');
										let attribute_constraint = tableRecord.substring(0, tableRecord.indexOf(","));
										if (attribute_constraint != attribute_data_type) {
											attribute_concept.set_constraint(attribute_constraint);
										};
									}
								}
							})
						})
						break;
				}
			};

			//ON SHOW.BS.MODAL EVENTS

			// (re)load the conceptList when Modal is opened
			$("#previewConceptList").on('show.bs.modal', function () {
				$('#conceptlistalerts').empty();
				let numberconceptswithoutsynonymsretrieved = conceptList.filter(concept => concept.synonyms_retrieved == false && concept.type != 'schema');
				if (numberconceptswithoutsynonymsretrieved.length > 0) {
					$.fn.push_alert('conceptlistalerts', 'warning', 'No synonyms were retrieved for ' + numberconceptswithoutsynonymsretrieved.length +
						' concept(s). Do you want to retrieve synonyms for them? Inteplato could find more matches based on similiar synonyms.',
						'setsynonymsallbutton', 'success', 'Retrieve synonyms');
				};
				conceptList.forEach(conceptObj => conceptObj.modify_concept_name()); //filter DB1_ ...
				$.fn.generateConceptList();
			});

			$("#previewConceptListHotEnc").on('show.bs.modal', function () {
				$('#conceptlistalertsHotEnc').empty();
				let numberconceptswithoutsynonymsretrieved = conceptList.filter(concept => concept.synonyms_retrieved == false && concept.type != 'schema');
				if (numberconceptswithoutsynonymsretrieved.length > 0) {
					$.fn.push_alert('conceptlistalerts', 'warning', 'No synonyms were retrieved for ' + numberconceptswithoutsynonymsretrieved.length +
						' concept(s). Do you want to retrieve synonyms for them? Inteplato could find more matches based on similiar synonyms.',
						'setsynonymsallbutton', 'success', 'Retrieve synonyms');
				};
				conceptList.forEach(conceptObj => conceptObj.modify_concept_name()); //filter DB1_ ...
				$.fn.generateConceptListHotEnc();
			});


			$.fn.generateConceptList = function () {
				let tbody = $('#conceptListTable tbody');
				let props = ["draw", "id", "name", "refined_local_name", "synonyms", "parent_id", "type",
					"schema", "data_type", "constraint_name", "constraint_ref_id", "global_id"];

				tbody.empty();

				$.each(conceptList, function (i, concept) {
					var tr = $('<tr>');
					$.each(props, function (i, prop) {
						if (prop === "draw") {
							if (concept.type != 'schema') {
								if (concept[prop] == true || concept[prop] == 'true') {
									$('<td>').html("<input class='form-check-input' type='checkbox' checked value='" + concept[prop] +
										"' onchange=this.setAttribute('value',(this.getAttribute('value')==='false'?true:false));concept_id_to_concept('" + concept.id + "').set_draw(this.getAttribute('value'));>").appendTo(tr);
								} else {
									$('<td>').html("<input class='form-check-input' type='checkbox' value='" + concept[prop] +
										"' onchange=this.setAttribute('value',(this.getAttribute('value')==='false'?true:false));concept_id_to_concept('" + concept.id + "').set_draw(this.getAttribute('value'));>").appendTo(tr);
								}
							} else {
								$('<td>').html(' ').appendTo(tr);
							}
						} else if (prop === "refined_local_name") {
							if (concept.type != 'schema') {
								$('<td>').html("<input class='form-control form-control-sm conceptmannameinput' type='text' value='" + concept.refined_local_name +
									"' data-conceptid='" + concept.id + "'>").appendTo(tr);
							} else {
								$('<td>').html(' ').appendTo(tr);
							}
						} else if (prop === 'synonyms') {
							if (concept.type != 'schema') {
								if (concept.synonyms_retrieved === true) {
									$('<td>').html("<button type='button' class='btn btn-sm conceptsynonymsbtn btn-outline-success' data-conceptid='" + concept.id + "' data-bs-toggle='tooltip' data-bs-html='true' title='" + concept.synonyms + "'><span data-feather='tag'></span></button>").appendTo(tr);
								} else {
									$('<td>').html("<button type='button' class='btn btn-sm conceptsynonymsbtn' data-conceptid='" + concept.id + "' data-bs-toggle='tooltip' data-bs-html='true' title='" + concept.synonyms + "'><span data-feather='tag'></span></button>").appendTo(tr);
								}
							} else {
								$('<td>').html(' ').appendTo(tr);
							}
						} else {
							$('<td>').html(concept[prop]).appendTo(tr);
						}
					});
					tbody.append(tr);
				});

				//reload button feather icons appended dynamically
				feather.replace()
			};

			$.fn.generateConceptListHotEnc = function () {
				let tbody = $('#conceptListTableHotEnc tbody');
				let props = ["id", "refined_local_name", "parent_id", "schema",
					//vector hot encoding representation meta
					"vec_type_schema", "vec_type_table", "vec_type_attribute",
					//vector hot encoding representation data type
					"vec_datatype_numeric", "vec_datatype_text", "vec_datatype_date", "vec_datatype_miscellaneous",
					//vector hot encoding representation constraint
					"vec_constraint_pk", "vec_constraint_fk", "constraint_ref_id", "vec_constraint_notnull", "vec_constraint_default",
					"vec_constraint_unique", "vec_constaint_check", "global_id"];

				tbody.empty();

				$.each(conceptList, function (i, concept) {
					var tr = $('<tr>');
					$.each(props, function (i, prop) {
						$('<td>').html(concept[prop]).appendTo(tr);
					});
					tbody.append(tr);
				});
			};


			// Concept List Hot Enc download as CSV
			$("#CLHotEncCSVDownload").on('click', function () {
				tableToCSV("conceptListTableHotEnc");
			});

			// Local Matcher algorithm
			$("#localMatcher").on('click', function () {
				let conceptsS = get_all_schemata_concepts();
				let conceptsGT = get_all_global_table_concepts();
				conceptsGT.forEach(function (conceptGT) {
					let conceptGTmatrixConceptsLT = conceptGT.tablelocalconceptfinder();
					conceptsS.forEach(function (conceptS) {
						let conceptGTmatrixconceptSConceptsLT = conceptGTmatrixConceptsLT.
							filter(conceptSConceptsLT => conceptSConceptsLT.schema == conceptS.name);
						let conceptLTMax = conceptGTmatrixconceptSConceptsLT[0] //total score sorted arr -> take first
						let conceptLTMaxScnd = conceptGTmatrixconceptSConceptsLT[1]
						if ((conceptLTMaxScnd.total_score / conceptLTMax.total_score) < 0.99) {
							concept_id_to_concept(conceptLTMax.id).set_global_concept(conceptGT.id);
						} else {
							console.log(conceptGT.id + ' has similarly scored local concepts. Human support required for ' + conceptS.name);
						}
					});

					let conceptsGA = conceptGT.get_all_children_concepts();
					if (conceptsGA != undefined) {
						conceptsGA.forEach(function (conceptGA) {
							let conceptGAmatrixConceptsLA = conceptGA.attributelocalconceptfinder(true);
							conceptsS.forEach(function (conceptS) {
								let conceptGAmatrixConceptSConceptsLA = conceptGAmatrixConceptsLA.
									filter(conceptSConceptsLA => conceptSConceptsLA.schema == conceptS.name);
								let conceptLAMax = conceptGAmatrixConceptSConceptsLA[0] //total score sorted arr -> take first 
								let conceptLAMaxScnd = conceptGAmatrixConceptSConceptsLA[1]
								if ((conceptLAMaxScnd.total_score / conceptLAMax.total_score) < 0.99) {
									concept_id_to_concept(conceptLAMax.id).set_global_concept(conceptGA.id);
								} else {
									console.log(conceptGA.id + ' has similarly scored local concepts. Human support required for ' + conceptS.name);
								}
							})
						})
					}
					//let conceptLTMax = Math.max.apply(Math, conceptGTmatrixconceptSConceptsLT.map(function(conceptLT) {
					//	 return conceptLT.total_score; 
					//}))
				});
			});

			// (re)load the Metadata table when Modal is opened
			$("#previewMetadata").on('show.bs.modal', function () {
				$.fn.generateMetadataTable();
			});

			$.fn.generateMetadataTable = function () {
				var tbody = $('#metadataTable tbody'),
					props = ["id", "name", "transformation1", "transformation2", "transformation3"];

				tbody.empty();

				$.each(conceptList.filter(conceptObj => conceptObj.schema === "global"), function (i, concept) {
					var tr = $('<tr>');
					$.each(props, function (i, prop) {
						$('<td>').html(concept[prop]).appendTo(tr);
					});
					tbody.append(tr);
				});
			};

			let sqltablecards = ['SELECT', '*', 'FROM', 'INNER JOIN', 'LEFT JOIN', 'RIGHT JOIN', 'FULL JOIN', 'UNION', 'ON', '='];
			let sqlattrcards = [" || ' ' || ", "CONCAT", "(", ")", "AS"];
			// (re)load the transformation screen when Modal is opened 
			$("#edittransformation").on('show.bs.modal', function () {
				$("#textareatransform1").empty();
				$("#textareatransform2").empty();
				$("#textareatransform3").empty();
				$("#edittransformationheader").empty();
				$("#sqlelementlist").empty();
				$("#sqlrelatedconcepts").empty();

				let global_concept = concept_id_to_concept($('#conceptid').val());
				$("#edittransformationheader").html("Global " + global_concept.type + ' ' + global_concept.name + ' is represented as: ');

				$("#textareatransform1").val(global_concept.transformation1);
				$("#textareatransform2").val(global_concept.transformation2);
				$("#textareatransform3").val(global_concept.transformation3);

				conceptList.filter(conceptsConnected => conceptsConnected.global_id.includes(global_concept.id)).
					forEach(sqlrelconcept => $("#sqlrelatedconcepts").append("<a href='#' class='list-group-item list-group-item-action'>" +
						sqlrelconcept.name + "</a>"));

				if (global_concept.type === 'table') {
					sqltablecards.forEach(sqlcard => $("#sqlelementlist").append("<a href='#' class='list-group-item list-group-item-action'>" +
						sqlcard + "</a>"));
				} else if (global_concept.type === 'attribute') {
					sqlattrcards.forEach(sqlcard => $("#sqlelementlist").append("<a href='#' class='list-group-item list-group-item-action'>" +
						sqlcard + "</a>"));
				};
			});

			// (re)load the previewlocalconceptfinder screen when Modal is opened  
			$("#previewlocalconceptfinder").on('show.bs.modal', function () {
				$('#localconceptfinderalerts').empty();
				let numberconceptswithoutsynonymsretrieved = conceptList.filter(concept => concept.synonyms_retrieved == false && concept.type != 'schema');
				if (numberconceptswithoutsynonymsretrieved.length > 0) {
					$.fn.push_alert('localconceptfinderalerts', 'warning', 'No synonyms were retrieved for ' + numberconceptswithoutsynonymsretrieved.length +
						' concept(s). Do you want to retrieve synonyms for them? Inteplato could find more matches based on similiar synonyms.',
						'setsynonymsallbutton', 'success', 'Retrieve synonyms');
				};

				let global_concept = concept_id_to_concept($('#conceptid').val());

				let header = $('#localconceptfinderheader');
				header.empty();
				let headline = 'Mapping suggestions for global <b>' + global_concept.type + ' ' + global_concept.name + ' (' + global_concept.id + ')</b>:</br>';
				let description = 'Retrieved Synonyms (' + global_concept.synonyms.length + ') for refined name name <b>' + global_concept.refined_local_name + '</b> are <b>' + global_concept.synonyms + '</b></br>';
				header.append(headline + description);

				let thead = $('#localConceptFinderMatches thead');
				let tbody = $('#localConceptFinderMatches tbody');
				thead.empty();
				tbody.empty();
				let props = [];

				//table specific
				if (global_concept.type == 'table') {
					//content to be compared to for tables
					props = ['id', 'name', 'refined_local_name', 'schema', 'synonyms', 'fuzzy search', '#datatypes', 'tot score table', 'tot score attribute', 'tot score', 'set'];
					propsLatex = ['id', 'local_name', 'refined_local_name', 'schema', 'synonyms', 'fuzzy search', '#datatypes', 'tot score table', 'tot score attribute', 'tot score', 'set'];
					//'#attributes', '#foreignkeys',
					union = global_concept.tablelocalconceptfinder();

				} // attribute specific
				else if (global_concept.type == 'attribute') {
					//content to be compared to for attributes
					props = ['id', 'name', 'refined_local_name', 'schema', 'synonyms', 'fuzzy search', 'datatype', 'constraint', 'tot score attribute', 'tot score table', 'tot score', 'set'];
					propsLatex = ['id', 'local_name', 'refined_local_name', 'schema', 'synonyms', 'fuzzy search', 'datatype', 'constraint', 'tot score attribute', 'tot score table', 'tot score', 'set'];

					union = global_concept.attributelocalconceptfinder(true);
				};


				//prepare dom table columns depending on concept being table or attribute
				let informationColumns = '<tr>';
				//props.forEach(function (prop) { //LATEX
				propsLatex.forEach(function (prop) {
					informationColumns = informationColumns + '<th scope="col">' + prop + '</th>';
				});
				informationColumns = informationColumns + '</tr>';
				thead.append(informationColumns);

				//insert into table				
				union.forEach(function (concept_score) {
					let concept = concept_id_to_concept(concept_score.id);
					var tr = $('<tr>');
					$.each(props, function (i, prop) {
						if (prop === "synonyms") {
							$('<td>').html(concept_score.synonyms_score).appendTo(tr);
						} else if (prop === "fuzzy search") {
							$('<td>').html(concept_score.fuzzy_score).appendTo(tr);
						} else if (prop === "#attributes") {
							$('<td>').html(concept_score.compare_attributes).appendTo(tr);
						} else if (prop === "#foreignkeys") {
							$('<td>').html(concept_score.compare_foreignkeys).appendTo(tr);
						} else if (prop === "#datatypes") {
							$('<td>').html(concept_score.compare_datatypes).appendTo(tr);
						} else if (prop === "datatype") {
							$('<td>').html(concept_score.same_datatype).appendTo(tr);
						} else if (prop === "constraint") {
							$('<td>').html(concept_score.same_constraint).appendTo(tr);
						} else if (prop === 'set') {
							if (concept.global_id.includes(global_concept.id)) {
								$('<td>').html("<button type='button' class='btn btn-sm setglobalconceptbtn btn-outline-success' data-conceptid='" + concept.id + "' title='Click to set " + concept.id + " as local concept.'><span data-feather='mouse-pointer'></span></button>").appendTo(tr);
							} else {
								$('<td>').html("<button type='button' class='btn btn-sm setglobalconceptbtn' data-conceptid='" + concept.id + "' title='Click to set " + concept.id + " as local concept.'><span data-feather='mouse-pointer'></span></button>").appendTo(tr);
							}
						} else if (prop === "tot score attribute") {
							$('<td>').html(concept_score.total_score_attribute).appendTo(tr);
						} else if (prop === "tot score table") {
							$('<td>').html(concept_score.total_score_table).appendTo(tr);
						} else if (prop === "tot score") {
							$('<td>').html(concept_score.total_score).appendTo(tr);
						} else {
							$('<td>').html(concept[prop]).appendTo(tr);
						}
					});
					tbody.append(tr);
				});


				//reload button feather icons appended dynamically
				feather.replace();
			});


			//MODAL EVENTS
			$("#insertschema").click(function () {
				$("#modalSchemaGlobal").empty(); //automatic quality test
				$("#modalSchemaGlobal").val(SampleXMLOracleCO); //automatic quality test
			});

			$("#clearschema").click(function () {
				svg.selectAll('path').remove();
				svg.selectAll('g').remove();
			});

			$("#importAllSchemaFormats").click(function () {
				$.fn.fileToConceptList($("#modalSchemaGlobal").val(), "global", $("#formatSchemaModelGlobal").find(":selected").val());

				numberOfLocalSchemas.forEach(function (schemaCounter) {
					$.fn.fileToConceptList($("#modalSchema" + schemaCounter).val(), "SCHEMA" + schemaCounter, $("#formatSchemaModel" + schemaCounter).find(":selected").val());
				});
			});

			$("#drawSelectedConcepts").click(function () {
				conceptList.filter(concept => concept.type == 'table' && concept.type != 'schema' && concept.is_drawn == false && concept.draw == true).
					forEach(function (concept) {
						concept.draw_concept(svg);
						concept.get_all_children_concepts().forEach(function (children_concept) {
							children_concept.draw_concept(svg);
						})
					});
			});

			$('#conceptdatatype').on('input', function () {
				var concept = concept_id_to_concept($('#conceptid').val());
				concept.data_type = $('#conceptdatatype').val().toUpperCase();
			});

			$('#conceptconstraint').on('input', function () {
				var concept = concept_id_to_concept($('#conceptid').val());
				concept.constraint_name = $('#conceptconstraint').val().toUpperCase();
				concept.check_constraint_color();
			});

			$('#conceptListTable tbody').on('click', 'button.conceptsynonymsbtn', function () {
				let concept = concept_id_to_concept($(this).attr('data-conceptid'));
				concept.set_synonyms();

				let that = this;
				setTimeout(function () {
					$(that).attr('title', concept.synonyms);
					$(that).addClass('btn-outline-success');
				}, 300);
			});

			$('#localConceptFinderMatches tbody').on('click', 'button.setglobalconceptbtn', function () {
				let concept = concept_id_to_concept($(this).attr('data-conceptid'));
				concept.set_global_concept($('#conceptid').val());

				//refresh conceptmeta of global concept
				concept_id_to_concept($('#conceptid').val()).update_conceptmeta();

				//make button green if connect
				$(this).addClass('btn-outline-success');
			});

			$('#globalconceptmeta ul').on('click', 'button.removeglobalconceptbtn', function () {
				let concept = concept_id_to_concept($(this).attr('data-conceptid'));
				concept.remove_global_concept($('#conceptid').val());
			});


			$('#conceptListTable tbody').on('input', 'input.conceptmannameinput', function () {
				let concept = concept_id_to_concept($(this).attr('data-conceptid'));
				concept.refined_local_name = this.value;
				concept.synonyms_retrieved = false;
				concept.synonyms = [];
			});

			$('#sqlelementlist,#sqlrelatedconcepts').on('click', 'a', function () {
				let current_sql_string = $("#sqlstrings").find("div.active").find("textarea").val();
				let new_sql_string = current_sql_string + ' ' + $(this).text();
				$("#sqlstrings").find("div.active").find("textarea").val(new_sql_string);
			});

			$('#localconceptfinderalerts').on('click', '#setsynonymsallbutton', function () {
				conceptList.filter(concept => concept.synonyms_retrieved == false && concept.type != 'schema').
					forEach(function (concept) {
						concept.set_synonyms();
					});
				$('#localconceptfinderalerts').empty();
			})

			$('#conceptlistalerts').on('click', '#setsynonymsallbutton', function () {
				conceptList.filter(concept => concept.synonyms_retrieved == false && concept.type != 'schema').
					forEach(function (concept) {
						concept.set_synonyms();
					});
				$('#conceptlistalerts').empty();
			})

			$('#modalsavetransformation').on('click', function () {
				let global_concept = concept_id_to_concept($('#conceptid').val());
				global_concept.transformation1 = $("#textareatransform1").val();
				global_concept.transformation2 = $("#textareatransform2").val();
				global_concept.transformation3 = $("#textareatransform3").val();
			});

			//NEW CANONICAL CONCEPT EVENTS
			$("#newglobaltableconcept").click(function () {
				$.fn.addGlobalTableConcept();
			});
			$("#newglobalattributeconcept").click(function () {
				$.fn.addGlobalAttributeConcept();
			});

			// FILTER EVENTS
			$("#tablesfilter").click(function () {
				if (this.checked == true) {
					conceptList.filter(concept => concept.type === "table").
						forEach(conceptObj => conceptObj.get_drawn_concept().classed("invisible", false));
					d3.selectAll(".tabtoattr").classed("invisible", false);
				} else {
					conceptList.filter(concept => concept.type === "table").
						forEach(conceptObj => conceptObj.get_drawn_concept().classed("invisible", true));
					d3.selectAll(".tabtoattr").classed("invisible", true);
				}
			});

			$("#attributesfilter").click(function () {
				if (this.checked == true) {
					conceptList.filter(concept => concept.type === "attribute")
						.forEach(conceptObj => conceptObj.get_drawn_concept().classed("invisible", false));
					d3.selectAll(".tabtoattr").classed("invisible", false);
				} else {
					conceptList.filter(concept => concept.type === "attribute")
						.forEach(conceptObj => conceptObj.get_drawn_concept().classed("invisible", true));
					d3.selectAll(".tabtoattr").classed("invisible", true);
				}
			});

			$("#tabtoattrfilter").click(function () {
				if (this.checked == true) {
					d3.selectAll(".tabtoattr").classed("invisible", false);
				} else {
					d3.selectAll(".tabtoattr").classed("invisible", true);
				}
			});

			$("#globaltolocalfilter").click(function () {
				if (this.checked == true) {
					d3.selectAll(".globaltolocal").classed("invisible", false);
				} else {
					d3.selectAll(".globaltolocal").classed("invisible", true);
				}
			});

			$.fn.push_alert = function (alertdivid, type, text, additionalbuttonid, additionalbuttontype, additionalbuttontext) {
				//types = primary , secondary , success , danger , warning , info , light , dark
				let alertStart = "<div id='alertchooseglobaltable' class='alert alert-" + type + " alert-dismissible fade show' role='alert'>";
				let additionalbutton = '';
				if (additionalbuttonid !== undefined) {
					additionalbutton = "<div class='d-flex justify-content-end'><button id='" + additionalbuttonid + "' type='button' class='btn-" + additionalbuttontype + "'>" + additionalbuttontext + "</button></div>";
				}
				let closeBtn = "<button type='button' class='btn-close' data-bs-dismiss='alert' aria-label='Close'></button>";
				$('#' + alertdivid).append(alertStart + text + closeBtn + additionalbutton + '</div>');
			};


		});
	</script>

	<!-- Quality Assurance QS -->
	<script>
		var delay = (function () {
			var timer = 0;
			return function (callback, ms) {
				clearTimeout(timer);
				timer = setTimeout(callback, ms);
			};
		})();

		delay(function () {
			$('#addSchemaModal').trigger('click');
			$('#addSchemaModal').trigger('click');
			//$('#insertschema').trigger('click');//automatic quality test
			//$('#importAllSchemaFormats').trigger('click'); //automatic quality test
			//$('#insertSchemaModal .btn-close').trigger('click');
		}, 555); // end delay
	</script>

	<!-- Icons -->
	<script src="https://unpkg.com/feather-icons"></script>
	<script>
		feather.replace()
	</script>

	<!-- Graphs -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>

	<!-- Fuse.js-->
	<script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.js"></script>

</body>

</html>